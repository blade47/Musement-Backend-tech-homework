# Musement-Backend-tech-homework

## Step 1 | Development

Application that:
    gets the list of the cities from Musement's API and
    for each city gets the forecast for the next 2 days using http://api.weatherapi.com and print to STDOUT "Processed city [city name] | [weather today] - [wheather tomorrow]"

*Example:*
> Processed city Milan | Heavy rain - Partly cloudy
>
> Processed city Rome | Sunny - Sunny

### Usage

To run the script cd to the root of the project, update the composed packages and then:

```bash
php run.php
```
The output will be written in app.log (autogenerated at runtime).
To make it work you have to insert a valid 'WEATHERAPI_KEY' into the app/Config.php file.

### Dependencies

	[Monolog](https://github.com/Seldaek/monolog) for the logging.
	[PHPUnit](https://github.com/sebastianbergmann/phpunit/) for the unit tests.

### Author

Alessandro Afloarei - <alessandro.afloarei@gmail.com> - <http://alessandroafloarei.it><br />

### License

This small lib is licensed under the MIT License - see the [LICENSE](LICENSE) file for details


## Step 2 | API design (no code required)

Now that we have a service that reads the forecast for a city, we want to save this info in the Musement's API. The endpoint that receives information about weather for a city **does not exist**, we only have these 2 endpoints for cities

```
GET /api/v3/cities
GET /api/v3/cities/{id}
```

Please provide the design for:
- endpoint/s to set the forecast for a specific city
- endpoint/s to read the forecast for a specific city

Please consider that we need to answer questions like : 

 - What's the weather in [city] for today ?
 - What's the weather in [city] for tomorrow ? 
 - What's the weather in [city] for [day] ?

For each endpoint provide all required information: endpoint, payload, possible responses etc and description about the behavior.

### Possible solution

```json
"/cities/{cityId}/forecasts": {
            "post": {
                "description": "Save the forecasts for the specified city",
                "parameters": [
                    {
                        "name": "cityId", 
                        "description": "ID of the city"
                    }
                ],
                "requestBody": {
                    "description": "Forecast post request",
                    "content": {
                        "application/json": {
                            "schema": {
                                "forecasts": [
                                    {
                                        "date": "2021-01-24",
                                        "condition": "Overcast"
                                    },
                                    {
                                        "date": "2021-01-25",
                                        "condition": "Moderate snow"
                                    }
                                ]
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Returned when successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "description": "Resources created"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Returned when resource is not found"
                    },
                    "503": {
                        "description": "Returned when the service is unavailable"
                    }
                }
            },
            "get": {
                "description": "Get the forecasts for a city in the period specified between from_date and to_date. If from_date and to_date are not setted then are returned all the forecasts from the date of the request'",
                "parameters": [
                    {
                        "name": "cityId",
                        "description": "ID of the city"
                    },
                    {
                        "name": "from_date",
                        "description": "The date from which the forecasts should be retrieved"
                    },
                    {
                        "name": "to_date",
                        "description": "The date to which the forecasts should be retrieved"
                    },
                ],
                "responses": {
                    "200": {
                        "description": "Returned when successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "forecasts": [
                                        {
                                            "date": "2021-01-24",
                                            "condition": "Overcast"
                                        },
                                        {
                                            "date": "2021-01-25",
                                            "condition": "Light snow"
                                        },
                                        {
                                            "date": "2021-01-26",
                                            "condition": "Moderate snow"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Returned when resource is not found"
                    },
                    "503": {
                        "description": "Returned when the service is unavailable"
                    }
                }
            }
        }

"/cities/{cityId}/forecasts/{currently}": {
            "get": {
                "description": "Get the forecast from a given city of today or tomorrow",
                "parameters": [
                    {
                        "name": "cityId",
                        "description": "ID of the city"
                    },
                    {
                        "name": "currently",
                        "description": "Forecasts for today or tomorrow?",
                        "enum": [
                            "today",
                            "tomorrow"
                        ]
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Returned when successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "forecasts": [
                                        {
                                            "date": "2021-01-24",
                                            "condition": "Overcast"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Returned when resource is not found"
                    },
                    "503": {
                        "description": "Returned when the service is unavailable"
                    }
                }
            }
        }
```
